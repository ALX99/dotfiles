#!/bin/sh

#########
# Basic #
#########
alias q=exit
alias c=clear
alias r=ranger
alias e=$EDITOR
alias h='cd ~'
alias p=paccy
alias sp='sudo pacman'
alias g='git'
alias gc='git clone'
alias please='sudo !!'
alias cx='chmod +x'
# Go install
alias goi='go install'
# Go produce
alias gop='CGO_ENABLED=0 go install -v -a -ldflags "-s -w" -gcflags=all=-trimpath=$GOPATH -asmflags=all=-trimpath=$GOPATH'
alias gor='go run'
alias cloc='tokei'

###########
# Listing #
###########
alias ls='lsd -t'
alias ll="lsd -tl"
alias la="lsd -tA"
alias tree='lsd --tree --group-dirs last'
# list trash
alias lt=trash-list

##############
# Navigation #
##############
alias bin='cd ~/dotfiles/bin'
alias dots='cd ~/dotfiles'
alias config='cd ~/dotfiles/.config'
# jump to mark
alias m=jump

############
# Advanced #
############
# Show why the go modules are needed
alias gmod='go list -m all | fzf --height 40% --color --preview "go mod why -m \$(echo {} | cut -f 1 -d'"'"' '"'"')"'

########
# Misc #
########
alias t='trash-put'
alias rt='trash-restore'
alias ct='trash-empty'
alias x='extract'
# ZSH tries to use this alias
alias bye='~/./.local/bin/bye'
# Setting my custom keyboard
alias keyb='setxkbmap colemak && xmodmap ~/dotfiles/keymaps/xmodColemakCustom && xset r rate 210 30'
# restart dwm
alias restart="sudo rm -f /usr/local/bin/dwm && cd ~/dwm/ && git checkout master && git merge config && make clean && sudo make install && pkill dwm"
# managing suckless patches
alias reset='make clean && git reset --hard remotes/origin/master && rm -f config.h'
# compile protobuf with grpc included
alias protorpc='protoc --go_out=plugins=grpc:. *.proto'
# Better cat
alias cat='bat'

###############
# Better flags#
###############
#alias ls='ls -ht --color=auto --group-directories-first'
alias grep='grep --color=auto'
alias cp='cp -i'
alias mv='mv -i'
alias rm='rm -iv'
alias mkdir='mkdir -p'
alias free='free -h'
alias df='df -h'
alias upower='upower -i /org/freedesktop/UPower/devices/battery_BAT0'
alias du='ncdu'

goto(){
    dir=$(find "${1:-.}" -path '*/\.*' -prune \
        -o -type d -print 2> /dev/null | fzf +m) &&
        cd "$dir"
}
hgrep(){
  print -z $( ([ -n "$ZSH_NAME" ] && fc -l 1 || history) | fzf +s --tac | sed -r 's/ *[0-9]*\*? *//' | sed -r 's/\\/\\\\/g')
}
hrun(){
  eval $( ([ -n "$ZSH_NAME" ] && fc -l 1 || history) | fzf +s --tac | sed -r 's/ *[0-9]*\*? *//' | sed -r 's/\\/\\\\/g')
}

# Bring aliases to SSH target
sshs() {
    ssh "$@" "cat > /tmp/.bashrc_temp" < ~/.aliasrc
    ssh -t "$@" "bash --rcfile /tmp/.bashrc_temp ; rm /tmp/.bashrc_temp"
}

# go to directory
god() {
  dir=$(find ${1:-.} -path '*/\.*' -prune \
                  -o -type d -print 2> /dev/null | fzf +m) &&
  cd "$dir"
}

###########
# For FZF #
###########
_fzf_compgen_path() {
  fd --hidden --follow --exclude ".git" . "$1"
}

# Use fd to generate the list for directory completion
_fzf_compgen_dir() {
  fd --type d --hidden --follow -E ".git" . "$1" -E "Android"
}

